# üöÄ –ê–ì–ï–ù–¢ –î–õ–Ø –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê –°–ï–¢–ï–í–û–ì–û –¢–†–ê–§–ò–ö–ê

–ü—Ä–æ—Å—Ç–æ–π –∞–≥–µ–Ω—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å–µ—â–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∞–π—Ç–æ–≤.  
–î–∞–Ω–Ω—ã–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ JSON-—Ñ–∞–π–ª –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Elasticsearch —á–µ—Ä–µ–∑ Filebeat –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ Kibana.

---

## üß© –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç Python-—Å–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ **–ª–æ–∫–∞–ª—å–Ω—ã–π SIEM-–∞–≥–µ–Ω—Ç** –Ω–∞ Windows –∏ –¥–µ–ª–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –ü–æ–ª—É—á–∞–µ—Ç –¥–æ–º–µ–Ω—ã –∏–∑ IP-–∞–¥—Ä–µ—Å–æ–≤ (—á–µ—Ä–µ–∑ –æ–±—Ä–∞—Ç–Ω—ã–π DNS)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –¥–æ–º–µ–Ω "—Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã–º" (–Ω–∞–ø—Ä–∏–º–µ—Ä, `vk.com`)
- –õ–æ–≥–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ JSON-—Ñ–∞–π–ª
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å ELK (Elasticsearch + Kibana) —á–µ—Ä–µ–∑ Filebeat
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –æ—Å–Ω–æ–≤—É –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (HTTPS, MITM, GUI)

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
siem_agent/
‚îú‚îÄ‚îÄ agent/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py                # –ö–æ–Ω—Ñ–∏–≥: —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã–µ –¥–æ–º–µ–Ω—ã
‚îÇ   ‚îú‚îÄ‚îÄ network_monitor.py       # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ trigger_handler.py       # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ logger.py                # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ main.py                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ logs/
‚îÇ       ‚îî‚îÄ‚îÄ traffic_logs.json    # –õ–æ–≥–∏ —Å–æ–±—ã—Ç–∏–π
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ domains.yaml             # –°–ø–∏—Å–æ–∫ —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ helpers.py               # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ install.bat                  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ run.bat                      # –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞
‚îú‚îÄ‚îÄ requirements.txt             # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îî‚îÄ‚îÄ README.md                    # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## üß∞ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è      | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|----------------|------------|
| Python 3.10     | –û—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| psutil          | –ß—Ç–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π |
| scapy           | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è —Å–Ω–∏—Ñ—Ñ–∏–Ω–≥–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ |
| PyYAML          | –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ñ–∏–≥–∞–º–∏ |
| Elasticsearch   | –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ª–æ–≥–æ–≤ |
| Kibana          | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö |
| Filebeat        | –ü–µ—Ä–µ–¥–∞—á–∞ –ª–æ–≥–æ–≤ –≤ Elasticsearch |

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
```

> –î–ª—è —Ä–∞–±–æ—Ç—ã `scapy` –Ω–∞ Windows —É—Å—Ç–∞–Ω–æ–≤–∏ Npcap: https://nmap.org/npcap/

---

### 2. –ù–∞—Å—Ç—Ä–æ–π Filebeat

–°–æ–∑–¥–∞–π –∏–ª–∏ –æ–±–Ω–æ–≤–∏ `filebeat.yml`:

```yaml
filebeat.inputs:
  - type: filestream
    enabled: true
    id: siem-agent-json-logs
    paths:
      - D:\siem_agent\data\logs\traffic_logs.json
    json.keys_under_root: true
    json.add_error_key: true

output.elasticsearch:
  hosts: ["http://localhost:9200"]
  index: "siem-agent-%{+yyyy.MM.dd}"

setup.kibana:
  host: "http://localhost:5601"
```

–ó–∞–ø—É—Å—Ç–∏ Filebeat:

```powershell
.\filebeat.exe -e -c filebeat.yml
```

---

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≥–µ–Ω—Ç

```powershell
cd agent
python main.py
```

–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π `.bat`:

```bat
@echo off
cd /d "%~dp0%"
python main.py
```

---

## üìå –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≥–µ–Ω—Ç

1. **network_monitor.py** ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ `psutil`.
2. **trigger_handler.py** ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ –¥–æ–º–µ–Ω –≤ —Å–ø–∏—Å–∫–µ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤.
3. **logger.py** ‚Äî –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –≤ JSON-—Ñ–∞–π–ª —Å –ø–æ–ª—è–º–∏:
   ```json
   {
     "timestamp": "2025-05-17T12:00:00",
     "domain": "vk.com",
     "triggered": true,
     "event": {
       "category": "security",
       "type": "alert"
     },
     "user": "admin"
   }
   ```
4. **Filebeat** —Å—á–∏—Ç—ã–≤–∞–µ—Ç JSON-—Ñ–∞–π–ª –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ **Elasticsearch**.
5. **Kibana** –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.

---

## üõ°Ô∏è –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ Kibana

1. –ü–µ—Ä–µ–π–¥–∏ –≤ **Analytics ‚Üí Discover**
2. –ò—Å–ø–æ–ª—å–∑—É–π —Ñ–∏–ª—å—Ç—Ä—ã:

```kql
event.category : "security"
```

–∏–ª–∏

```kql
message:"event" AND message:"security"
```

3. –°–æ–∑–¥–∞–π –¥–∞—à–±–æ—Ä–¥ –≤ **Analytics ‚Üí Dashboard**

---

## üß™ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ HTTPS-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ü–∞—Ä—Å–∏–Ω–≥ URL –∏–∑ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Windows Event Log
- –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Tkinter / PyQt)
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Telegram, Email)
- –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ —Å–ª—É–∂–±—ã Windows

---

## ‚úÖ –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞                          | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç |
|----------------------------------|------------|
| `python main.py`                 | –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞ |
| `curl http://localhost:9200`     | –ü—Ä–æ–≤–µ—Ä–∫–∞ Elasticsearch |
| `curl http://localhost:5601`     | –ü—Ä–æ–≤–µ—Ä–∫–∞ Kibana |
| `netstat -ano`                  | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤ |

---


## üôå –ê–≤—Ç–æ—Ä

*Mara Chedder*  
–î–∞—Ç–∞: 2025-05-17  
–ü—Ä–æ–µ–∫—Ç: SIEM-–∞–≥–µ–Ω—Ç –¥–ª—è Windows

---
